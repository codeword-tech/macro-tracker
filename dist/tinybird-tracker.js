var tinybirdTrackerJs=function(){var e=function(e){var n=e.document,t=e.localStorage;if(e&&e.document&&e.document.currentScript){var r=(y("api")||new URL(n.currentScript.src).origin)+"/v0/events",o=y("source"),i=y("token"),s=y("cookie-domain")||e.location.hostname,u=y("function")||"tinybird";if(!o)throw new Error("'dataSource' name is required to start sending events");if(!i)throw new Error("'token' is required to start sending events");var a="tinybird_events",c=5e3,d=function(n){for(var t="tinybird=",r=e.document.cookie.split(";"),o=0;o<r.length;++o){for(var i=r[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return null}(),f=JSON.parse(t.getItem(a)||"[]"),x=b(),l=!1;d||(d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}),e.document.cookie="tinybird="+(d||"")+"; path=/; domain="+s),e.addEventListener("beforeunload",w),e.addEventListener("unload",w,!1);var h=e[u]||[];e[u]=g;for(var p=0;p<h.length;p++)g.apply(this,h[p]);v(c,5)}function m(e){function n(){e>0&&(l=!1,v(c,e-1))}l||(f.length>0?(l=!0,function(e,n){return n=n||{},new Promise(function(t,r){var o=new XMLHttpRequest,i=[],s=[],u={},a=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:a,headers:{keys:function(){return i},entries:function(){return s},get:function(e){return u[e.toLowerCase()]},has:function(e){return e.toLowerCase()in u}}}};for(var c in o.open(n.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,n,t){i.push(n=n.toLowerCase()),s.push([n,t]),u[n]=u[n]?u[n]+","+t:t}),t(a())},o.onerror=r,o.withCredentials="include"==n.credentials,n.headers)o.setRequestHeader(c,n.headers[c]);o.send(n.body||null)})}(r+"?name="+o+"&token="+i,{method:"POST",body:S(f)}).then(function(e){return e.json()}).then(function(e){e?(f=[],t.setItem(a,"[]"),v(c,5)):n(),l=!1}).catch(function(e){n()})):v(c,5))}function v(e,n){setTimeout(function(){m(n)},e)}function g(e,n){var t=n||{};t.event=e||"",t.timestamp=b(),t.session_start=x,t.uuid=d,f.push(t)}function w(){t.setItem(a,JSON.stringify(f)),m()}function S(e){return e.map(e=>JSON.stringify(e)).join("\n")}function b(e){return(e=e||new Date).toISOString().replace("T"," ").split(".")[0]}function y(e){return n.currentScript.getAttribute("data-"+e)}};return e(window),e}();
//# sourceMappingURL=tinybird-tracker.js.map
